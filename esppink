-- pink_esp.lua
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ESPBoxes = {}

local function CreateESP(player)
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then return end
    local box = Instance.new("BoxHandleAdornment")
    box.Adornee = player.Character.HumanoidRootPart
    box.Size = Vector3.new(2, 5, 1)
    box.Color3 = Color3.fromRGB(255, 105, 180)
    box.Transparency = 0.5
    box.AlwaysOnTop = true
    box.ZIndex = 10
    box.Parent = workspace
    ESPBoxes[player] = box
end

local function UpdateESP()
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            if _G.ESPEnabled then
                if not ESPBoxes[player] then
                    CreateESP(player)
                else
                    ESPBoxes[player].Adornee = player.Character.HumanoidRootPart
                end
            else
                if ESPBoxes[player] then
                    ESPBoxes[player]:Destroy()
                    ESPBoxes[player] = nil
                end
            end
        end
    end
end

RunService.RenderStepped:Connect(UpdateESP)

Players.PlayerRemoving:Connect(function(player)
    if ESPBoxes[player] then
        ESPBoxes[player]:Destroy()
        ESPBoxes[player] = nil
    end
end)
